# ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼
> _**ä½œè€…: DataWhale**_
> 
> _**åŸæ–‡:**_ [_**https://mp.weixin.qq.com/s/vNO6o3R9SM0C\_\_cZnNoNvw**_](https://mp.weixin.qq.com/s/vNO6o3R9SM0C__cZnNoNvw)

ä¸€æ–‡è¯¦å°½ä¹‹Embedding(å‘é‡è¡¨ç¤º)ï¼
---------------------

åœ¨å¤§æ¨¡å‹æ—¶ä»£,Embedding(å‘é‡è¡¨ç¤º)çš„é‡è¦æ€§æ„ˆå‘å‡¸æ˜¾.

ä¸è®ºæ˜¯åœ¨ RAG ç³»ç»Ÿ,è¿˜æ˜¯åœ¨è·¨æ¨¡æ€ä»»åŠ¡ä¸­éƒ½æ‰®æ¼”ç€å…³é”®è§’è‰².

æœ¬æ–‡å¸¦ä½ è¯¦ç»†äº†è§£æ–‡æœ¬å‘é‡çš„å‰ä¸–ä»Šç”Ÿ,è®©ä½ èƒ½å¤Ÿæ›´å¥½åœ°äº†è§£å‘é‡,ä½¿ç”¨å‘é‡.

**1\. æ–‡æœ¬è¡¨ç¤ºæ¨¡å‹ç®€ä»‹**
----------------

æ–‡æœ¬æ˜¯ä¸€ç±»éå¸¸é‡è¦çš„éç»“æ„åŒ–æ•°æ®,å¦‚ä½•è¡¨ç¤ºæ–‡æœ¬æ•°æ®ä¸€ç›´æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸçš„ä¸€ä¸ªé‡ç‚¹ç ”ç©¶æ–¹å‘.æ–‡æœ¬å‘é‡å°±æ˜¯æ·±åº¦å­¦ä¹ æ—¶ä»£äº§ç”Ÿçš„ä¸€ç§æ–‡æœ¬è¡¨ç¤ºçš„æ–¹æ³•.

**1.1 ç‹¬çƒ­ç¼–ç **

æœ€ç®€å•çš„æ–‡æœ¬è¡¨ç¤ºæ¨¡å‹å°±æ˜¯ç‹¬çƒ­ç¼–ç (One-Hot Encoding),ç”¨äºå°†è¯æ±‡è¡¨ä¸­çš„æ¯ä¸ªè¯è½¬æ¢ä¸ºä¸€ä¸ªé«˜ç»´ç¨€ç–å‘é‡,æ¯ä¸ªè¯çš„å‘é‡ä¸­åªæœ‰ä¸€ä¸ªä½ç½®ä¸º1,å…¶ä½™ä½ç½®ä¸º0.å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªè¯æ±‡è¡¨(è¯å…¸)V,å…¶ä¸­åŒ…å«Nä¸ªå”¯ä¸€çš„è¯.æ¯ä¸ªè¯å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªé•¿åº¦ä¸ºNçš„äºŒè¿›åˆ¶å‘é‡.åœ¨è¿™ä¸ªå‘é‡ä¸­,åªæœ‰ä¸€ä¸ªä½ç½®ä¸º1,å¯¹åº”äºè¯¥è¯åœ¨è¯æ±‡è¡¨ä¸­çš„ä½ç½®,å…¶ä½™ä½ç½®å‡ä¸º0.ä¾‹å¦‚,å‡è®¾è¯æ±‡è¡¨ä¸º: \["I", "love", "machine", "learning"\]: "I" çš„ç‹¬çƒ­è¡¨ç¤ºä¸º\[1, 0, 0, 0\] "love" çš„ç‹¬çƒ­è¡¨ç¤ºä¸º\[0, 1, 0, 0\] "machine" çš„ç‹¬çƒ­è¡¨ç¤ºä¸º\[0, 0, 1, 0\] "learning" çš„ç‹¬çƒ­è¡¨ç¤ºä¸º\[0, 0, 0, 1\]

è¿™ç§è¡¨ç¤ºæ–¹æ³•çš„**ç¼ºç‚¹**:

1.  **\>é«˜ç»´ç¨€ç–æ€§**: å¯¹äºå¤§è¯æ±‡è¡¨,ç‹¬çƒ­å‘é‡çš„ç»´åº¦éå¸¸é«˜ä¸”ç¨€ç–,å¯¼è‡´è®¡ç®—å’Œå­˜å‚¨æ•ˆç‡ä½.
2.  **\>æ— æ³•æ•æ‰è¯è¯­ä¹‹é—´çš„å…³ç³»**: ç‹¬çƒ­è¡¨ç¤ºæ— æ³•æ•æ‰è¯è¯­ä¹‹é—´çš„è¯­ä¹‰å…³ç³»,æ‰€æœ‰è¯è¢«è®¤ä¸ºæ˜¯ç‹¬ç«‹ä¸”ç­‰è·çš„.

**1.2 è¯è¢‹æ¨¡å‹ä¸N-gramæ¨¡å‹**
---------------------

åœ¨**è¯è¢‹æ¨¡å‹(Bag-of-Words, BoW)** ä¸­,æ¯ä¸ªæ–‡æ¡£è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡.å‘é‡çš„æ¯ä¸ªä½ç½®å¯¹åº”äºè¯æ±‡è¡¨ä¸­çš„ä¸€ä¸ªè¯,å‘é‡çš„å€¼ä¸ºè¯¥è¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°(æˆ–å…¶ä»–ç»Ÿè®¡é‡,å¦‚è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡(TF-IDF)).å‡è®¾æœ‰ä¸¤ä¸ªæ–‡æ¡£,æ–‡æ¡£1: "I love machine learning."å’Œæ–‡æ¡£2: "I love machine learning. Machine learning is great.":

*   æ„å»ºè¯æ±‡è¡¨: \["I", "love", "machine", "learning", "is", "great"\]
*   æ–‡æ¡£1çš„è¯è¢‹å‘é‡: \[1, 1, 1, 1, 0, 0\]
*   æ–‡æ¡£2çš„è¯è¢‹å‘é‡: \[1, 1, 2, 2, 1, 1\]

è¯è¢‹æ¨¡å‹æ²¡æœ‰è€ƒè™‘è¯çš„é¡ºåºå’Œä¸Šä¸‹æ–‡ä¿¡æ¯,**N-gramæ¨¡å‹**é€šè¿‡è€ƒè™‘æ–‡æœ¬ä¸­è¿ç»­ n ä¸ªè¯çš„åºåˆ—æ¥æ•æ‰è¯çš„é¡ºåºå’Œå±€éƒ¨ä¸Šä¸‹æ–‡ä¿¡æ¯.n-gram å¯ä»¥æ˜¯ unigram(1-gram),bigram(2-gram),trigram(3-gram)ç­‰.å‡è®¾æœ‰ä¸€ä¸ªæ–‡æ¡£: "I love machine learning.":

*   ç”Ÿæˆ bigram(2-gram): \["I love", "love machine", "machine learning"\]
*   æ„å»ºè¯æ±‡è¡¨: \["I love", "love machine", "machine learning"\]
*   æ–‡æ¡£çš„ bigram å‘é‡: \[1, 1, 1\]

**1.3 ä¸»é¢˜æ¨¡å‹**
------------

åŸºäºè¯è¢‹æ¨¡å‹ä¸N-gramæ¨¡å‹çš„æ–‡æœ¬è¡¨ç¤ºæ¨¡å‹æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºé™·,å°±æ˜¯**æ— æ³•è¯†åˆ«å‡ºä¸¤ä¸ªä¸åŒçš„è¯æˆ–è¯ç»„å…·æœ‰ç›¸åŒçš„ä¸»é¢˜**.å› æ­¤,éœ€è¦ä¸€ç§æŠ€æœ¯èƒ½å¤Ÿå°†å…·æœ‰ç›¸åŒä¸»é¢˜çš„è¯æˆ–è¯ç»„æ˜ å°„åˆ°åŒä¸€ç»´åº¦ä¸Šå»,äºæ˜¯äº§ç”Ÿäº†ä¸»é¢˜æ¨¡å‹.**ä¸»é¢˜æ¨¡å‹**(ä»£è¡¨pLSAæ¨¡å‹,LDAæ¨¡å‹)æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¦‚ç‡å›¾æ¨¡å‹,ä¸»è¦è§£å†³äº†ä¸¤ä¸ªé—®é¢˜:

*   ä»æ–‡æœ¬åº“ä¸­å‘ç°æœ‰ä»£è¡¨æ€§çš„ä¸»é¢˜(ä¸»é¢˜æ•°ä½œä¸ºè¶…å‚æ•°éœ€è¦è‡ªå·±å®šä¹‰)->è¯åˆ†å¸ƒ,è¡¨ç¤ºä¸»é¢˜å’Œè¯çš„å¯¹åº”å…³ç³»
*   æ¯ç¯‡æ–‡ç« å¯¹åº”ç€å“ªäº›ä¸»é¢˜->ä¸»é¢˜åˆ†å¸ƒ,è¡¨ç¤ºæ–‡æ¡£å’Œä¸»é¢˜çš„å¯¹åº”å…³ç³»

**ä¸»é¢˜æ¨¡å‹çš„ä¼˜ç‚¹**:

*   å…¨å±€ä¸»é¢˜å»ºæ¨¡,èƒ½å¤Ÿå‘ç°é•¿è·ç¦»è¯ä¾èµ–ä¿¡æ¯ï¼›
*   å°†æ–‡æ¡£è¡¨ç¤ºä¸ºä¸»é¢˜çš„æ¦‚ç‡åˆ†å¸ƒ,é€šå¸¸ç»´åº¦è¾ƒä½(ç­‰äºä¸»é¢˜æ•°),å¯ä»¥æœ‰æ•ˆåœ°é™ä½æ•°æ®çš„ç¨€ç–æ€§.è´å¶æ–¯å­¦æ´¾å’Œé¢‘ç‡å­¦æ´¾â€œæ­£ç»Ÿâ€ä¹‹äº‰([https://www.zhihu.com/question/20587681/answer/23060072](https://www.zhihu.com/question/20587681/answer/23060072))

**1.4 è¯å‘é‡**
-----------

**è¯å‘é‡(è¯åµŒå…¥,Word Embedding)** æ˜¯å°†æ¯ä¸ªè¯éƒ½æ˜ å°„åˆ°ä½ç»´ç©ºé—´ä¸Šçš„ä¸€ä¸ªç¨ å¯†å‘é‡(Dense Vector).è¿™é‡Œçš„ä½ç»´ç©ºé—´ä¸Šçš„æ¯ä¸€ç»´ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸­ä¸€ä¸ªä¸»é¢˜æ¨¡å‹ä¸­çš„ä¸€ä¸ªä¸»é¢˜,åªä¸è¿‡ä¸åƒä¸»é¢˜æ¨¡å‹ä¸­é‚£ä¹ˆç›´è§‚(ä¸å…·å¤‡å¯è§£é‡Šæ€§).è¯å‘é‡åœ¨å­¦ä¹ æ—¶è€ƒè™‘åˆ°äº†å½“å‰è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯,ä»¥Word2Vecä¸ºä¾‹,å®ƒå®é™…ä¸Šæ˜¯ä¸€ç§æµ…å±‚çš„ç¥ç»ç½‘ç»œæ¨¡å‹(è¾“å…¥å±‚ã€æ˜ å°„å±‚ã€è¾“å‡ºå±‚),å®ƒæœ‰ä¸¤ç§ç½‘ç»œç»“æ„,åˆ†åˆ«æ˜¯CBOWå’ŒSkip-gram,å‚è€ƒä¸‹å›¾:

![](ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.jp)

ä¸ç®¡æ˜¯CBOWè¿˜æ˜¯Skip-gram,éƒ½æ˜¯é€šè¿‡**æœ€å¤§åŒ–ä¸Šä¸‹æ–‡è¯å‡ºç°çš„æ¦‚ç‡æ¥è¿›è¡Œæ¨¡å‹çš„ä¼˜åŒ–**.å…¶ä»–å¸¸è§çš„è¯åµŒå…¥æ–¹æ³•,è¿˜æœ‰**GloVe(Global Vectors for Word Representation)ã€FastText**.

**è¯å‘é‡çš„å‡ ä½•æ€§: è¯åµŒå…¥çš„å‘é‡ç©ºé—´å…·å¤‡å‡ ä½•æ€§**,å› æ­¤å…è®¸ä½¿ç”¨**å‘é‡ä¹‹é—´çš„è·ç¦»å’Œè§’åº¦æ¥è¡¡é‡ç›¸ä¼¼æ€§**.å¸¸ç”¨çš„ç›¸ä¼¼åº¦åº¦é‡åŒ…æ‹¬:

*   **\>ä½™å¼¦ç›¸ä¼¼åº¦**: è¡¡é‡ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦,ç›¸ä¼¼åº¦è¶Šé«˜,è§’åº¦è¶Šå°.
*   **\>æ¬§æ°è·ç¦»**: è¡¡é‡ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„ç›´çº¿è·ç¦»,è·ç¦»è¶Šå°,è¯è¯­ä¹‹é—´è¶Šç›¸ä¼¼.

![](15_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

è¯å‘é‡å­˜åœ¨çš„é—®é¢˜:Â 

1.  \>ä¸Šä¸‹æ–‡æ— å…³: Â è¯å‘é‡ä¸ºé™æ€å‘é‡,å³åŒä¸€ä¸ªè¯åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­æœ‰ç›¸åŒçš„å‘é‡è¡¨ç¤º,è¿™å¯¼è‡´è¯å‘é‡æ— æ³•è§£å†³â€œä¸€è¯å¤šä¹‰â€é—®é¢˜.
2.  \>OOVé—®é¢˜: Â æœªç™»å½•è¯é—®é¢˜(Out-Of-Vocabulary),è¯åµŒå…¥æ¨¡å‹åœ¨è®­ç»ƒæ—¶å»ºç«‹ä¸€ä¸ªå›ºå®šçš„è¯æ±‡è¡¨,ä»»ä½•ä¸åœ¨è¯æ±‡è¡¨ä¸­çš„è¯éƒ½è¢«è§†ä¸º OOV.
3.  \>è¯­æ³•å’Œè¯­ä¹‰ä¿¡æ¯çš„æ•æ‰ä¸è¶³: Â è¯åµŒå…¥æ¨¡å‹ä¸»è¦æ•æ‰è¯è¯­çš„å…±ç°ä¿¡æ¯,å¯èƒ½æ— æ³•å……åˆ†æ•æ‰è¯è¯­ä¹‹é—´çš„å¤æ‚è¯­æ³•å’Œè¯­ä¹‰å…³ç³».

**1.5 å¥å‘é‡**
-----------

**å¥å‘é‡(Sentence Embedding)** æ˜¯å°†æ•´ä¸ªå¥å­è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„å‘é‡è¡¨ç¤ºçš„æ–¹æ³•.æœ€ç®€å•çš„å¥å‘é‡è·å–æ–¹å¼æ˜¯åŸºäºå¹³å‡è¯å‘é‡çš„æ–¹æ³•: å°†å¥å­ä¸­çš„æ¯ä¸ªè¯è½¬æ¢ä¸ºè¯å‘é‡,ç„¶åå¯¹è¿™äº›è¯å‘é‡å–å¹³å‡å¾—åˆ°å¥å­å‘é‡.

### **1.5.1 è¯å‘é‡+sifæˆ–è€…usif**

ä¸Šé¢ä»‹ç»çš„è¯å‘é‡ç›¸åŠ æ±‚å¹³å‡è·å–å¥å‘é‡çš„æ–¹æ³•,ç¼ºç‚¹ä¹‹ä¸€æ˜¯æ²¡æœ‰è€ƒè™‘åˆ°å¥å­ä¸­ä¸åŒè¯ä¹‹é—´çš„é‡è¦æ€§å·®å¼‚,å› ä¸ºæ‰€æœ‰è¯éƒ½æ˜¯ä¸€æ ·çš„æƒé‡.åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­,æœ‰å°è¯•ä½¿ç”¨tf-idfå¯¹è¯è¿›è¡ŒåŠ æƒ,ä½†æ˜¯æ•ˆæœæå‡æœ‰é™.2016å¹´æå‡ºæ¥SIFåŠ æƒç®—æ³•,ä½¿ç”¨éšæœºæ¸¸èµ°æ¥æ¨ç®—å¥å­çš„ç”Ÿæˆæ¦‚ç‡.2018å¹´å‘è¡¨åœ¨ACLçš„USIF(ã€ŒUnsupervised Random Walk Sentence Embeddingsã€[https://aclanthology.org/W18-3012.pdf)ç®—æ³•,æ˜¯å¯¹SIFåŠ æƒç®—æ³•çš„æ”¹è¿›.æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹ã€Œè¿™ä¸€ç¯‡ã€https://zhuanlan.zhihu.com/p/263511812](https://aclanthology.org/W18-3012.pdf)%E7%AE%97%E6%B3%95,%E6%98%AF%E5%AF%B9SIF%E5%8A%A0%E6%9D%83%E7%AE%97%E6%B3%95%E7%9A%84%E6%94%B9%E8%BF%9B.%E6%84%9F%E5%85%B4%E8%B6%A3%E7%9A%84%E5%8F%AF%E4%BB%A5%E7%9C%8B%E7%9C%8B%E3%80%8C%E8%BF%99%E4%B8%80%E7%AF%87%E3%80%8Dhttps://zhuanlan.zhihu.com/p/263511812).

### **1.5.2 Doc2vec**

Doc2vecæ˜¯åŸºäº Word2Vec æ¨¡å‹æ‰©å±•è€Œæ¥,ç›¸å¯¹äºword2vecä¸åŒä¹‹å¤„åœ¨äº,åœ¨è¾“å…¥å±‚,å¢æ·»äº†ä¸€ä¸ªæ–°çš„å¥å­å‘é‡**Paragraph vector**,Paragraph vectorå¯ä»¥è¢«çœ‹ä½œæ˜¯å¦ä¸€ä¸ªè¯å‘é‡.Doc2vecæ¯æ¬¡è®­ç»ƒä¹Ÿæ˜¯**æ»‘åŠ¨æˆªå–å¥å­ä¸­ä¸€å°éƒ¨åˆ†è¯æ¥è®­ç»ƒ**,Paragraph Vectoråœ¨**åŒä¸€ä¸ªå¥å­çš„è‹¥å¹²æ¬¡è®­ç»ƒä¸­æ˜¯å…±äº«çš„**,è¿™æ ·è®­ç»ƒå‡ºæ¥çš„Paragraph vectorå°±ä¼šé€æ¸åœ¨æ¯å¥å­ä¸­çš„å‡ æ¬¡è®­ç»ƒä¸­ä¸æ–­ç¨³å®šä¸‹æ¥,å½¢æˆè¯¥å¥å­çš„ä¸»æ—¨.

ç±»ä¼¼äº Word2Vec,å®ƒä¹ŸåŒ…å«ä¸¤ç§è®­ç»ƒæ–¹å¼:

1.  **PV-DM (Distributed Memory Model of paragraph vectors)æ¨¡å‹**
    *   ç»™å®šä¸€ä¸ªæ–‡æ¡£Då’Œä¸€ä¸ªçª—å£å¤§å°\_>w\_,é€‰æ‹©ä¸€ä¸ªç›®æ ‡è¯\_>w\_t\_å’Œå®ƒçš„ä¸Šä¸‹æ–‡è¯\_>w\_{t-1}, ..., w\_{t+w}\_
    *   å°†æ–‡æ¡£Dçš„å‘é‡å’Œä¸Šä¸‹æ–‡è¯çš„å‘é‡ä¸€èµ·è¾“å…¥æ¨¡å‹,è¿›è¡Œç›¸åŠ æ±‚å¹³å‡æˆ–è€…ç´¯åŠ æ„æˆä¸€ä¸ªæ–°çš„å‘é‡\_>X\_,åŸºäºè¯¥å‘é‡é¢„æµ‹ç›®æ ‡è¯\_>w\_t\_

![](16_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

1.  **PV-DBOW(Distributed Bag of Words of paragraph vector)æ¨¡å‹**
    *   ç»™å®šä¸€ä¸ªæ–‡æ¡£D,éšæœºé€‰æ‹©ä¸€ä¸ªç›®æ ‡è¯\_>w\_t\_
    *   ä½¿ç”¨æ–‡æ¡£Dçš„å‘é‡é¢„æµ‹ç›®æ ‡è¯\_>w\_t\_

![](1_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

**Doc2vecçš„æ¨ç†ä¼˜åŒ–: åœ¨é¢„æµ‹æ–°çš„\*å¥å­å‘é‡(æ¨ç†)æ—¶,Paragraph vectoré¦–å…ˆè¢«éšæœºåˆå§‹åŒ–**,æ”¾å…¥æ¨¡å‹ä¸­å†é‡æ–°æ ¹æ®**éšæœºæ¢¯åº¦ä¸‹é™**ä¸æ–­è¿­ä»£æ±‚å¾—æœ€ç»ˆç¨³å®šä¸‹æ¥çš„å¥å­å‘é‡.ä¸è®­ç»ƒæ—¶ç›¸æ¯”,æ­¤æ—¶**è¯¥æ¨¡å‹çš„è¯å‘é‡å’ŒæŠ•å½±å±‚åˆ°è¾“å‡ºå±‚çš„soft weightså‚æ•°å›ºå®š**,åªå‰©ä¸‹Paragraph vectorç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚å¾—,æ‰€ä»¥é¢„æµ‹æ–°å¥å­æ—¶è™½ç„¶ä¹Ÿè¦æ”¾å…¥æ¨¡å‹ä¸­ä¸æ–­è¿­ä»£æ±‚å‡º,**ç›¸æ¯”äºè®­ç»ƒæ—¶,é€Ÿåº¦ä¼šå¿«å¾—å¤š**.

**2\. åŸºäºBertçš„æ–‡æœ¬å‘é‡**
-------------------

**2.1 Bertå‘é‡çš„å„å‘å¼‚æ€§**
-------------------

å°†æ–‡æœ¬è¾“å…¥Bertæ¨¡å‹ä¸­å,é€šå¸¸ä½¿ç”¨æœ€åä¸€ä¸ªéšè—å±‚ä¸­\[CLS\]æ ‡è®°å¯¹åº”çš„å‘é‡æˆ–å¯¹æœ€åä¸€ä¸ªéšè—å±‚åšMeanPooling,æ¥è·å–è¯¥æ–‡æœ¬å¯¹åº”çš„å‘é‡è¡¨ç¤º.

![](3_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

ä¸ºä»€ä¹ˆBertå‘é‡è¡¨ç¤ºä¸èƒ½ç›´æ¥ç”¨äºç›¸ä¼¼åº¦è®¡ç®—ï¼Ÿæ ¸å¿ƒåŸå› å°±æ˜¯: **å„å‘å¼‚æ€§(anisotropy)**.å„å‘å¼‚æ€§æ˜¯ä¸€ä¸ªç‰©ç†å­¦ã€ææ–™ç§‘å­¦é¢†åŸŸçš„æ¦‚å¿µ,åŸæœ¬æŒ‡ææ–™æˆ–ç³»ç»Ÿåœ¨ä¸åŒæ–¹å‘ä¸Šè¡¨ç°å‡ºä¸åŒç‰©ç†æ€§è´¨çš„ç°è±¡.ä½œä¸ºåƒè´§çš„æˆ‘ä»¬è‚¯å®šéå¸¸æœ‰ç»éªŒ,åƒè‚‰çš„æ—¶å€™é¡ºçº¹åˆ‡çš„è‚‰æ¯”æ¨ªçº¹åˆ‡çš„è‚‰æ›´æœ‰åš¼åŠ².ç±»ä¼¼çš„è¿˜æœ‰æœ¨å¤´çš„é¡ºçº¹å’Œæ¨ªçº¹çš„æŠ—å‹å’ŒæŠ—æ‹‰èƒ½åŠ›ä¹Ÿä¸åŒ,çŸ³å¢¨å•æ™¶çš„ç”µå¯¼ç‡åœ¨ä¸åŒæ–¹å‘å·®å¼‚å¾ˆå¤§.**å„å‘å¼‚æ€§åœ¨å‘é‡ç©ºé—´ä¸Šçš„å«ä¹‰å°±æ˜¯åˆ†å¸ƒä¸æ–¹å‘æœ‰å…³ç³»,è€Œå„å‘åŒæ€§å°±æ˜¯å„ä¸ªæ–¹å‘éƒ½ä¸€æ ·**,æ¯”å¦‚äºŒç»´çš„ç©ºé—´,å„å‘å¼‚æ€§å’Œå„å‘åŒæ€§å¯¹æ¯”å¦‚ä¸‹(å·¦å›¾ä¸ºå„å‘å¼‚æ€§,å³å›¾ä¸ºå„å‘åŒæ€§).

![](2_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

**Bertçš„å„å‘å¼‚æ€§æ˜¯æŒ‡**: â€œAnisotropicâ€ means word embeddings occupy a narrow cone in the vector space. ç®€å•è§£é‡Šå°±æ˜¯,**è¯å‘é‡åœ¨å‘é‡ç©ºé—´ä¸­å æ®äº†ä¸€ä¸ªç‹­çª„çš„åœ†é”¥å½¢ä½“**.Bertçš„è¯å‘é‡åœ¨ç©ºé—´ä¸­çš„åˆ†å¸ƒå‘ˆç°é”¥å½¢,ç ”ç©¶è€…å‘ç°é«˜é¢‘çš„è¯éƒ½é è¿‘åŸç‚¹(æ‰€æœ‰è¯çš„å‡å€¼),è€Œä½é¢‘è¯è¿œç¦»åŸç‚¹,è¿™ä¼šå¯¼è‡´å³ä½¿ä¸€ä¸ªé«˜é¢‘è¯ä¸ä¸€ä¸ªä½é¢‘è¯çš„è¯­ä¹‰ç­‰ä»·,ä½†æ˜¯è¯é¢‘çš„å·®å¼‚ä¹Ÿä¼šå¸¦æ¥å·¨å¤§çš„å·®å¼‚,ä»è€Œè¯å‘é‡çš„è·ç¦»ä¸èƒ½å¾ˆå¥½çš„è¡¨è¾¾è¯é—´çš„è¯­ä¹‰ç›¸å…³æ€§.å¦å¤–,è¿˜å­˜åœ¨**é«˜é¢‘è¯åˆ†å¸ƒç´§å‡‘,ä½é¢‘è¯çš„åˆ†å¸ƒç¨€ç–**çš„é—®é¢˜.åˆ†å¸ƒç¨€ç–ä¼šå¯¼è‡´åŒºé—´çš„è¯­ä¹‰ä¸å®Œæ•´(poorly defined),ä½é¢‘è¯å‘é‡è®­ç»ƒçš„ä¸å……åˆ†,ä»è€Œå¯¼è‡´è¿›è¡Œå‘é‡ç›¸ä¼¼åº¦è®¡ç®—æ—¶å‡ºç°é—®é¢˜.

![](ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

ä¸åªæ˜¯Bert,å¤§å¤šæ•°Transformeræ¶æ„çš„é¢„è®­ç»ƒæ¨¡å‹å­¦ä¹ åˆ°çš„è¯å‘é‡ç©ºé—´(åŒ…æ‹¬GPT-2),éƒ½æœ‰ç±»ä¼¼çš„é—®é¢˜(æ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹ã€ŒGao et al. 2019ã€[https://arxiv.org/abs/1907.12009,ã€ŒWang](https://arxiv.org/abs/1907.12009,%E3%80%8CWang) et al. 2020ã€[https://openreview.net/pdf?id=ByxY8CNtvr,ã€ŒEthayarajh](https://openreview.net/pdf?id=ByxY8CNtvr,%E3%80%8CEthayarajh), 2019ã€[https://arxiv.org/abs/1909.00512](https://arxiv.org/abs/1909.00512)):

![](6_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

**å„é¡¹å¼‚æ€§çš„ç¼ºç‚¹: Â ä¸€ä¸ªå¥½çš„å‘é‡è¡¨ç¤ºåº”è¯¥åŒæ—¶æ»¡è¶³**alignment**å’Œ**uniformity,å‰è€…è¡¨ç¤º**ç›¸ä¼¼çš„å‘é‡è·ç¦»åº”è¯¥ç›¸è¿‘**,åè€…å°±è¡¨ç¤º**å‘é‡åœ¨ç©ºé—´ä¸Šåº”è¯¥å°½é‡å‡åŒ€**,æœ€å¥½æ˜¯å„å‘åŒæ€§çš„.å„å‘å¼‚æ€§å°±æœ‰ä¸ªé—®é¢˜,é‚£å°±æ˜¯æœ€åå­¦åˆ°çš„**å‘é‡éƒ½æŒ¤åœ¨ä¸€èµ·,å½¼æ­¤ä¹‹é—´è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦éƒ½å¾ˆé«˜**,å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¡¨ç¤º.

![](4_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

å„é¡¹å¼‚æ€§é—®é¢˜çš„ä¼˜åŒ–æ–¹æ³•:Â 

1.  **\>æœ‰ç›‘ç£å­¦ä¹ ä¼˜åŒ–: Â é€šè¿‡æ ‡æ³¨è¯­æ–™æ„å»ºåŒå¡”Bertæˆ–è€…å•å¡”Bertæ¥è¿›è¡Œ**\>æ¨¡å‹å¾®è°ƒ,ä½¿é è¿‘ä¸‹æ¸¸ä»»åŠ¡çš„Bertå±‚å‘é‡æ›´åŠ é è¿‘å¥å­ç›¸ä¼¼embeddingçš„è¡¨è¾¾,ä»è€Œä½¿å‘é‡ç©ºé—´å¹³æ»‘.æœ‰ç›‘ç£å­¦ä¹ ä¼˜åŒ–çš„ä»£è¡¨æ˜¯>SBERT.
2.  \>æ— ç›‘ç£å­¦ä¹ ä¼˜åŒ–:Â 
    1.  é€šè¿‡å¯¹Bertçš„å‘é‡ç©ºé—´è¿›è¡Œ>çº¿æ€§å˜æ¢,ç¼“è§£å„å‘å¼‚æ€§çš„é—®é¢˜.æ— ç›‘ç£å­¦ä¹ ä¼˜åŒ–çš„ä»£è¡¨æ˜¯>Bert-flow**å’Œ**\>Bert-whitening.
    2.  åŸºäº>å¯¹æ¯”å­¦ä¹ **çš„æ€æƒ³,é€šè¿‡å¯¹æ–‡æœ¬æœ¬èº«è¿›è¡Œ**\>å¢å¹¿(è½¬è¯‘ã€åˆ é™¤ã€æ’å…¥ã€è°ƒæ¢é¡ºåºã€Dropoutç­‰),æ‰©å±•å‡ºçš„å¥å­ä½œä¸ºæ­£æ ·æœ¬,å…¶ä»–å¥å­çš„å¢å¹¿ä½œä¸ºè´Ÿæ ·æœ¬,é€šè¿‡æ‹‰è¿‘æ­£æ ·æœ¬å¯¹çš„å‘é‡è·ç¦»,åŒæ—¶å¢åŠ ä¸è´Ÿæ ·æœ¬çš„å‘é‡è·ç¦»,å®ç°æ¨¡å‹ä¼˜åŒ–,åˆå«>è‡ªç›‘ç£å­¦ä¹ ä¼˜åŒ–,ä»£è¡¨å°±æ˜¯>SimCSE.

**2.2 æœ‰ç›‘ç£å­¦ä¹ ä¼˜åŒ–-Sentence-BERT(SBERT)**
------------------------------------

BERTå‘é‡æ¨¡å‹(SBERTæ¨¡å‹)ä¸BERTäº¤äº’å¼è¯­ä¹‰æ¨¡å‹(BERTäºŒåˆ†ç±»æ¨¡å‹)çš„åŒºåˆ«:

![](8_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

SBERTæ¨¡å‹é€šè¿‡å¯¹é¢„è®­ç»ƒçš„BERTç»“æ„è¿›è¡Œä¿®æ”¹,å¹¶é€šè¿‡åœ¨æœ‰ç›‘ç£ä»»åŠ¡(å¦‚è‡ªç„¶è¯­è¨€æ¨ç†ã€è¯­ä¹‰æ–‡æœ¬ç›¸ä¼¼åº¦)ä¸Šè¿›è¡Œå¾®è°ƒ,ä¼˜åŒ–Bertå‘é‡ç›´æ¥è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—çš„æ€§èƒ½.

![](17_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

SBERTæ¨¡å‹åˆ†ä¸º**å­ªç”Ÿ(Siamese)** å’Œ**ä¸‰çº§(triplet)** ç½‘ç»œ,é’ˆå¯¹ä¸åŒçš„ç½‘ç»œç»“æ„,è®¾ç½®äº†ä¸‰ä¸ªä¸åŒçš„ç›®æ ‡å‡½æ•°:

1.  **\>Classification Objective Function**: å­ªç”Ÿ(Siamese)ç½‘ç»œè®­ç»ƒ,é’ˆå¯¹åˆ†ç±»é—®é¢˜.ä¸Šå·¦å›¾,\_>u,\_\_>v\_åˆ†åˆ«è¡¨ç¤ºè¾“å…¥çš„2ä¸ªå¥å­çš„å‘é‡è¡¨ç¤º,\*|u-v|\*è¡¨ç¤ºå–ä¸¤ä¸ªå‘é‡element-wiseçš„ç»å¯¹å€¼.æ¨¡å‹è®­ç»ƒæ—¶ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°è®¡ç®—loss.

![](5_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

1.  **\>Regression Objective Function**: å­ªç”Ÿ(Siamese)ç½‘ç»œè®­ç»ƒ,é’ˆå¯¹å›å½’é—®é¢˜.ä¸Šå³å›¾,ç›´æ¥è®¡ç®—u,vå‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦,è®­ç»ƒæ—¶ä½¿ç”¨å‡æ–¹è¯¯å·®(Mean Squared Error, MSE)è¿›è¡Œlossè®¡ç®—.3.**\>Triplet Objective Function**: ä¸‰çº§(triplet)ç½‘ç»œè®­ç»ƒ,æ¨¡å‹æœ‰å˜æˆä¸‰ä¸ªå¥å­è¾“å…¥.ç»™å®šä¸€ä¸ªé”šå®šå¥\_>ğ‘\_,ä¸€ä¸ªè‚¯å®šå¥\_>ğ‘_å’Œä¸€ä¸ªå¦å®šå¥_\>ğ‘›\_,æ¨¡å‹é€šè¿‡ä½¿\_>ğ‘_ä¸_\>ğ‘_çš„è·ç¦»å°äºä¸_\>ğ‘_ä¸_\>ğ‘›\_çš„è·ç¦»,æ¥ä¼˜åŒ–æ¨¡å‹,å³

![](7_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

å…¶ä¸­,_ğœ–_ è¡¨ç¤ºè¾¹è·,åœ¨è®ºæ–‡ä¸­,è·ç¦»åº¦é‡ä¸ºæ¬§å¼è·ç¦»,è¾¹è·å¤§å°ä¸º1.

åŒä¸€æ—¶é—´çš„å…¶ä»–é’ˆå¯¹å¥å‘é‡çš„ç ”ç©¶,ã€ŒUSE(Universal Sentence Encoder)ã€[https://arxiv.org/abs/1803.11175ã€ã€ŒInferSentã€https://arxiv.org/abs/1705.02364ç­‰,ä»–ä»¬çš„å…±æ€§åœ¨äºéƒ½ä½¿ç”¨äº†â€œåŒå¡”â€ç±»çš„ç»“æ„](https://arxiv.org/abs/1803.11175%E3%80%81%E3%80%8CInferSent%E3%80%8Dhttps://arxiv.org/abs/1705.02364%E7%AD%89,%E4%BB%96%E4%BB%AC%E7%9A%84%E5%85%B1%E6%80%A7%E5%9C%A8%E4%BA%8E%E9%83%BD%E4%BD%BF%E7%94%A8%E4%BA%86%E2%80%9C%E5%8F%8C%E5%A1%94%E2%80%9D%E7%B1%BB%E7%9A%84%E7%BB%93%E6%9E%84).

å…³äºè‡ªç„¶æ¨ç†ä»»åŠ¡ï¼Ÿè‡ªç„¶è¯­è¨€æ¨ç†(Natural Language Inference, NLI)æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†(NLP)ä¸­çš„ä¸€ä¸ªé‡è¦ä»»åŠ¡,æ—¨åœ¨åˆ¤æ–­ä¸¤ä¸ªç»™å®šå¥å­ä¹‹é—´çš„é€»è¾‘å…³ç³».å…·ä½“æ¥è¯´,NLIä»»åŠ¡é€šå¸¸æ¶‰åŠä¸‰ä¸ªä¸»è¦çš„é€»è¾‘å…³ç³»:

1.  **\>è•´å«(Entailment)**: å‰æ(Premise)è•´å«å‡è®¾(Hypothesis),å³å¦‚æœå‰æä¸ºçœŸ,åˆ™å‡è®¾ä¹Ÿä¸ºçœŸ.
2.  **\>çŸ›ç›¾(Contradiction)**: å‰æä¸å‡è®¾ç›¸çŸ›ç›¾,å³å¦‚æœå‰æä¸ºçœŸ,åˆ™å‡è®¾ä¸ºå‡.
3.  **\>ä¸­ç«‹(Neutral)**: å‰æä¸å‡è®¾æ—¢ä¸è•´å«ä¹Ÿä¸çŸ›ç›¾,å³å‰æä¸ºçœŸæ—¶,å‡è®¾å¯èƒ½ä¸ºçœŸä¹Ÿå¯èƒ½ä¸ºå‡.

**ä½¿ç”¨NLIçš„æ ‡æ³¨æ•°æ®é›†(SNLI,MNLIç­‰)è®­ç»ƒå‡ºçš„è¯­ä¹‰å‘é‡æ¨¡å‹,å±•ç°å‡ºäº†è¾ƒå¥½çš„è¯­ä¹‰æ‰©å±•æ€§å’Œé²æ£’æ€§,é€‚åˆè¿›è¡Œzero-shotæˆ–è€…few-shot.**

**2.3 æ— ç›‘ç£å­¦ä¹ ä¼˜åŒ–**
---------------

### **2.3.1 Bert-flow**

æ—¢ç„¶Bertå‘é‡ç©ºé—´ä¸å‡åŒ€,é‚£å°±æƒ³åŠæ³•æŠŠè¯¥å‘é‡ç©ºé™æ˜ å°„ä¸€ä¸ªå‡åŒ€çš„ç©ºé—´ä¸­,ä¾‹å¦‚**æ ‡å‡†é«˜æ–¯(Standard Gaussian)** åˆ†å¸ƒ.ã€ŒBERT-flowã€[https://arxiv.org/abs/2011.05864,å°±æ˜¯åŸºäºæµå¼ç”Ÿæˆæ¨¡å‹,å°†BERTçš„è¡¨ç¤ºå¯é€†åœ°æ˜ å°„åˆ°ä¸€ä¸ªæ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸Š.å…·ä½“åšæ³•æ˜¯,åœ¨Bertåé¢æ¥ä¸€ä¸ªflowæ¨¡å‹,flowæ¨¡å‹çš„è®­ç»ƒæ˜¯æ— ç›‘ç£çš„,å¹¶ä¸”Bertçš„å‚æ•°æ˜¯ä¸å‚ä¸è®­ç»ƒ,åªæœ‰flowçš„å‚æ•°è¢«ä¼˜åŒ–,è€Œè®­ç»ƒçš„ç›®æ ‡åˆ™ä¸ºæœ€å¤§åŒ–é¢„å…ˆè®¡ç®—å¥½çš„Bertçš„å¥å‘é‡çš„ä¼¼ç„¶å‡½æ•°.è®­ç»ƒè¿‡ç¨‹ç®€å•è¯´å°±æ˜¯å­¦ä¹ ä¸€ä¸ªå¯é€†çš„æ˜ å°„ğ‘“,æŠŠæœä»é«˜æ–¯åˆ†å¸ƒçš„å˜é‡ğ‘§æ˜ å°„åˆ°BERTç¼–ç çš„ğ‘¢,é‚£ğ‘“âˆ’1å°±å¯ä»¥æŠŠğ‘¢æ˜ å°„åˆ°å‡åŒ€çš„é«˜æ–¯åˆ†å¸ƒ,è¿™æ—¶æˆ‘ä»¬æœ€å¤§åŒ–ä»é«˜æ–¯åˆ†å¸ƒä¸­äº§ç”ŸBERTè¡¨ç¤ºçš„æ¦‚ç‡,å°±å­¦ä¹ åˆ°äº†è¿™ä¸ªæ˜ å°„](https://arxiv.org/abs/2011.05864,%E5%B0%B1%E6%98%AF%E5%9F%BA%E4%BA%8E%E6%B5%81%E5%BC%8F%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B,%E5%B0%86BERT%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%8F%AF%E9%80%86%E5%9C%B0%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AA%E6%A0%87%E5%87%86%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83%E4%B8%8A.%E5%85%B7%E4%BD%93%E5%81%9A%E6%B3%95%E6%98%AF,%E5%9C%A8Bert%E5%90%8E%E9%9D%A2%E6%8E%A5%E4%B8%80%E4%B8%AAflow%E6%A8%A1%E5%9E%8B,flow%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AE%AD%E7%BB%83%E6%98%AF%E6%97%A0%E7%9B%91%E7%9D%A3%E7%9A%84,%E5%B9%B6%E4%B8%94Bert%E7%9A%84%E5%8F%82%E6%95%B0%E6%98%AF%E4%B8%8D%E5%8F%82%E4%B8%8E%E8%AE%AD%E7%BB%83,%E5%8F%AA%E6%9C%89flow%E7%9A%84%E5%8F%82%E6%95%B0%E8%A2%AB%E4%BC%98%E5%8C%96,%E8%80%8C%E8%AE%AD%E7%BB%83%E7%9A%84%E7%9B%AE%E6%A0%87%E5%88%99%E4%B8%BA%E6%9C%80%E5%A4%A7%E5%8C%96%E9%A2%84%E5%85%88%E8%AE%A1%E7%AE%97%E5%A5%BD%E7%9A%84Bert%E7%9A%84%E5%8F%A5%E5%90%91%E9%87%8F%E7%9A%84%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0.%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B%E7%AE%80%E5%8D%95%E8%AF%B4%E5%B0%B1%E6%98%AF%E5%AD%A6%E4%B9%A0%E4%B8%80%E4%B8%AA%E5%8F%AF%E9%80%86%E7%9A%84%E6%98%A0%E5%B0%84%F0%9D%91%93,%E6%8A%8A%E6%9C%8D%E4%BB%8E%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83%E7%9A%84%E5%8F%98%E9%87%8F%F0%9D%91%A7%E6%98%A0%E5%B0%84%E5%88%B0BERT%E7%BC%96%E7%A0%81%E7%9A%84%F0%9D%91%A2,%E9%82%A3%F0%9D%91%93%E2%88%921%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%8A%8A%F0%9D%91%A2%E6%98%A0%E5%B0%84%E5%88%B0%E5%9D%87%E5%8C%80%E7%9A%84%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83,%E8%BF%99%E6%97%B6%E6%88%91%E4%BB%AC%E6%9C%80%E5%A4%A7%E5%8C%96%E4%BB%8E%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83%E4%B8%AD%E4%BA%A7%E7%94%9FBERT%E8%A1%A8%E7%A4%BA%E7%9A%84%E6%A6%82%E7%8E%87,%E5%B0%B1%E5%AD%A6%E4%B9%A0%E5%88%B0%E4%BA%86%E8%BF%99%E4%B8%AA%E6%98%A0%E5%B0%84):

![](9_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

å…³äºæµå¼ç”Ÿæˆæ¨¡å‹çš„åŸç†,æ„Ÿå…´è¶£çš„è‡ªå·±çœ‹:

1.  ICLR 2015 NICE-Non-linear Independent Components Estimation
2.  ICLR 2017 Density estimation using Real NVP
3.  NIPS 2018 Glow: Generative Flow with Invertible 1Ã—1 Convolutions

### **2.3.2 Bert-whitening**

ã€ŒBert-whiteningã€([https://spaces.ac.cn/archives/8069)çš„ä½œè€…å°±æ˜¯è‹ç¥@è‹å‰‘æ—(https://www.zhihu.com/people/su-jian-lin-22),ä»–é¦–å…ˆåˆ†æäº†ä½™å¼¦ç›¸ä¼¼åº¦çš„å‡å®š](https://spaces.ac.cn/archives/8069)%E7%9A%84%E4%BD%9C%E8%80%85%E5%B0%B1%E6%98%AF%E8%8B%8F%E7%A5%9E@%E8%8B%8F%E5%89%91%E6%9E%97(https://www.zhihu.com/people/su-jian-lin-22),%E4%BB%96%E9%A6%96%E5%85%88%E5%88%86%E6%9E%90%E4%BA%86%E4%BD%99%E5%BC%A6%E7%9B%B8%E4%BC%BC%E5%BA%A6%E7%9A%84%E5%81%87%E5%AE%9A): ä½™å¼¦ç›¸ä¼¼åº¦çš„è®¡ç®—ä¸ºä¸¤ä¸ªå‘é‡çš„å†…ç§¯é™¤ä»¥å„è‡ªçš„æ¨¡é•¿,è€Œè¯¥å¼å­çš„å±€é™æ€§ä¸ºä»…åœ¨æ ‡å‡†æ­£äº¤åŸºä¸‹æˆç«‹.åŒæ—¶,ç»è¿‡å‡è®¾åˆ†æ,å¾—å‡ºç»“è®º: **ä¸€ä¸ªç¬¦åˆâ€œå„å‘åŒæ€§â€çš„ç©ºé—´å°±å¯ä»¥è®¤ä¸ºå®ƒæºäºæ ‡å‡†æ­£äº¤åŸº.ä»–è§‰å¾—Bert-flowè™½ç„¶æœ‰æ•ˆ,ä½†æ˜¯è®­ç»ƒflowæ¨¡å‹å¤ªéº»çƒ¦,å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ›´ç®€å•**çš„æ–¹å¼å®ç°ç©ºé—´è½¬æ¢.æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„å‡å€¼ä¸º0ã€åæ–¹å·®çŸ©é˜µä¸ºå•ä½é˜µ,å®ƒçš„åšæ³•å°±æ˜¯å°†Bertå‘é‡çš„å‡å€¼å˜æ¢ä¸º0ã€åæ–¹å·®çŸ©é˜µå˜æ¢ä¸ºå•ä½é˜µ,ä¹Ÿå°±æ˜¯ä¼ ç»Ÿæ•°æ®æŒ–æ˜ä¸­ä¸­çš„ç™½åŒ–(whitening)æ“ä½œ.

### **2.3.3 SimCSE**

![](10_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

**å¯¹æ¯”å­¦ä¹ (Contrastive learning)** çš„ç›®çš„æ˜¯é€šè¿‡å°†è¯­ä¹‰ä¸Šæ¥è¿‘çš„é‚»å±…æ‹‰åˆ°ä¸€èµ·,å°†éé‚»å±…æ¨å¼€,ä»è€Œå­¦ä¹ æœ‰æ•ˆçš„è¡¨å¾(ã€ŒHadsell et al., 2006ã€([https://ieeexplore.ieee.org/document/1640964)).SBertæ¨¡å‹æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§å¯¹æ¯”å­¦ä¹ çš„ä½“ç°,ä½†æ˜¯å®ƒéœ€è¦è¿›è¡Œæœ‰ç›‘ç£è®­ç»ƒ,ä¾èµ–æ ‡æ³¨æ•°æ®,å› æ­¤æ— æ³•åœ¨å¤§è§„æ¨¡çš„è¯­æ–™ä¸‹è¿›è¡Œè®­ç»ƒ.å¦‚æœèƒ½æ‰¾åˆ°ä¸€ç§æ–¹æ³•,èƒ½å¤ŸåŸºäºæ–‡æœ¬é¢„æ–™è‡ªåŠ¨ç”Ÿæˆç”¨äºSBertæ¨¡å‹è®­ç»ƒçš„æ•°æ®,å°±å¯ä»¥è§£å†³æ•°æ®æ ‡æ³¨ä¾èµ–çš„é—®é¢˜.åŸºäºå¯¹æ¯”å­¦ä¹ çš„æ— ç›‘ç£å­¦ä¹ æ–¹æ³•,å°±æ˜¯é€šè¿‡å¯¹æ–‡æœ¬æœ¬èº«è¿›è¡Œä¼ ç»Ÿçš„æ–‡æœ¬å¢å¹¿(å¦‚è½¬è¯‘ã€åˆ é™¤ã€æ’å…¥ã€è°ƒæ¢é¡ºåºç­‰ç­‰),å¹¶å°†å¢å¹¿åå¾—åˆ°çš„æ–‡æœ¬ä½œä¸ºæ­£æ ·æœ¬(å³å‡è®¾æ–‡æœ¬å¢å¹¿å‰å,è¯­ä¹‰ç›¸ä¼¼),åŒæ—¶å–åŒä¸€batchä¸‹,å…¶ä»–å¥å­çš„å¢å¹¿ç»“æœä½œä¸ºè´Ÿæ ·ä¾‹,å°±å¾—åˆ°äº†å¯ä»¥è¿›è¡ŒSBert(æˆ–åŒç±»æ¨¡å‹)è®­ç»ƒçš„é¢„æ–™.è€ŒSimCSE(https://arxiv.org/abs/2104.08821)å‘ç°,å‘ç°åˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹ä¸­è‡ªå¸¦çš„Dropout](https://ieeexplore.ieee.org/document/1640964)).SBert%E6%A8%A1%E5%9E%8B%E6%9C%AC%E8%BA%AB%E4%B9%9F%E6%98%AF%E4%B8%80%E7%A7%8D**%E5%AF%B9%E6%AF%94%E5%AD%A6%E4%B9%A0**%E7%9A%84%E4%BD%93%E7%8E%B0,%E4%BD%86%E6%98%AF%E5%AE%83%E9%9C%80%E8%A6%81%E8%BF%9B%E8%A1%8C%E6%9C%89%E7%9B%91%E7%9D%A3%E8%AE%AD%E7%BB%83,**%E4%BE%9D%E8%B5%96%E6%A0%87%E6%B3%A8%E6%95%B0%E6%8D%AE**,%E5%9B%A0%E6%AD%A4%E6%97%A0%E6%B3%95%E5%9C%A8%E5%A4%A7%E8%A7%84%E6%A8%A1%E7%9A%84%E8%AF%AD%E6%96%99%E4%B8%8B%E8%BF%9B%E8%A1%8C%E8%AE%AD%E7%BB%83.%E5%A6%82%E6%9E%9C%E8%83%BD%E6%89%BE%E5%88%B0%E4%B8%80%E7%A7%8D%E6%96%B9%E6%B3%95,%E8%83%BD%E5%A4%9F%E5%9F%BA%E4%BA%8E**%E6%96%87%E6%9C%AC%E9%A2%84%E6%96%99%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E7%94%A8%E4%BA%8ESBert%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83%E7%9A%84%E6%95%B0%E6%8D%AE**,%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%A7%A3%E5%86%B3%E6%95%B0%E6%8D%AE%E6%A0%87%E6%B3%A8%E4%BE%9D%E8%B5%96%E7%9A%84%E9%97%AE%E9%A2%98.%E5%9F%BA%E4%BA%8E**%E5%AF%B9%E6%AF%94%E5%AD%A6%E4%B9%A0**%E7%9A%84**%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0**%E6%96%B9%E6%B3%95,%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87%E5%AF%B9%E6%96%87%E6%9C%AC%E6%9C%AC%E8%BA%AB%E8%BF%9B%E8%A1%8C%E4%BC%A0%E7%BB%9F%E7%9A%84%E6%96%87%E6%9C%AC%E5%A2%9E%E5%B9%BF(%E5%A6%82%E8%BD%AC%E8%AF%91%E3%80%81%E5%88%A0%E9%99%A4%E3%80%81%E6%8F%92%E5%85%A5%E3%80%81%E8%B0%83%E6%8D%A2%E9%A1%BA%E5%BA%8F%E7%AD%89%E7%AD%89),%E5%B9%B6%E5%B0%86**%E5%A2%9E%E5%B9%BF%E5%90%8E%E5%BE%97%E5%88%B0%E7%9A%84%E6%96%87%E6%9C%AC**%E4%BD%9C%E4%B8%BA**%E6%AD%A3%E6%A0%B7%E6%9C%AC**(%E5%8D%B3%E5%81%87%E8%AE%BE%E6%96%87%E6%9C%AC%E5%A2%9E%E5%B9%BF%E5%89%8D%E5%90%8E,%E8%AF%AD%E4%B9%89%E7%9B%B8%E4%BC%BC),%E5%90%8C%E6%97%B6%E5%8F%96**%E5%90%8C%E4%B8%80batch%E4%B8%8B,%E5%85%B6%E4%BB%96%E5%8F%A5%E5%AD%90%E7%9A%84%E5%A2%9E%E5%B9%BF%E7%BB%93%E6%9E%9C%E4%BD%9C%E4%B8%BA%E8%B4%9F%E6%A0%B7%E4%BE%8B**,%E5%B0%B1%E5%BE%97%E5%88%B0%E4%BA%86%E5%8F%AF%E4%BB%A5%E8%BF%9B%E8%A1%8CSBert(%E6%88%96%E5%90%8C%E7%B1%BB%E6%A8%A1%E5%9E%8B)%E8%AE%AD%E7%BB%83%E7%9A%84%E9%A2%84%E6%96%99.%E8%80%8C**SimCSE(**https://arxiv.org/abs/2104.08821)%E5%8F%91%E7%8E%B0,%E5%8F%91%E7%8E%B0%E5%88%A9%E7%94%A8%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%E4%B8%AD%E8%87%AA%E5%B8%A6%E7%9A%84**Dropout) maskä½œä¸ºâ€œå¢å¹¿æ‰‹æ®µâ€å¾—åˆ°çš„Sentence Embeddings,å…¶è´¨é‡è¿œå¥½äºä¼ ç»Ÿçš„æ–‡æœ¬å¢å¹¿æ–¹æ³•:

![](11_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

1.  åˆ©ç”¨æ¨¡å‹ä¸­çš„Dropout mask,å¯¹æ¯ä¸€ä¸ªæ ·ä¾‹è¿›è¡Œ>ä¸¤æ¬¡å‰å‘ä¼ æ’­,å¾—åˆ°ä¸¤ä¸ªä¸åŒçš„embeddingså‘é‡,å°†åŒä¸€ä¸ªæ ·ä¾‹å¾—åˆ°çš„å‘é‡å¯¹ä½œä¸ºæ­£æ ·æœ¬å¯¹,å¯¹äºæ¯ä¸€ä¸ªå‘é‡,é€‰å–åŒä¸€ä¸ªbatchä¸­æ‰€æœ‰æ ·ä¾‹äº§ç”Ÿçš„embeddingså‘é‡ä½œä¸ºè´Ÿæ ·æœ¬,ä»¥æ­¤æ¥è®­ç»ƒæ¨¡å‹.è®­ç»ƒæŸå¤±å‡½æ•°ä¸º:

![](12_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

1.  SimCSEä¹Ÿæä¾›äº†>æœ‰ç›‘ç£å­¦ä¹ çš„è®­ç»ƒèŒƒå¼,åˆ©ç”¨NLIæ ‡æ³¨æ•°æ®é›†è¿›è¡Œè®­ç»ƒ,å°†æ¯ä¸€ä¸ªæ ·ä¾‹å’Œä¸å…¶ç›¸å¯¹çš„entailmentä½œä¸ºæ­£æ ·æœ¬å¯¹,åŒä¸€ä¸ªbatchä¸­å…¶ä»–æ ·ä¾‹çš„entailmentä½œä¸ºè´Ÿæ ·æœ¬,è¯¥æ ·æœ¬ç›¸å¯¹åº”çš„contradictionä½œä¸ºhard negativeè¿›è¡Œè®­ç»ƒ.è®­ç»ƒæŸå¤±å‡½æ•°ä¸º:

![](14_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

**3\. å¤§æ¨¡å‹æ—¶ä»£çš„å±•æœ›**
----------------

éšç€LLMæ¨¡å‹æ—¶ä»£çš„åˆ°æ¥,ä»€ä¹ˆæ‰æ˜¯LLMæ—¶ä»£å‘é‡æ¨¡å‹è®­ç»ƒçš„èŒƒå¼ï¼Ÿè‡ªåŠ¨ç¼–ç orå¯¹æ¯”å­¦ä¹ ï¼Ÿæˆ‘ä»¬ä¼šæŒç»­å…³æ³¨.

![](13_ä¸€æ–‡è¯¦å°½ä¹‹Embeddingï¼ˆå‘é‡è¡¨ç¤ºï¼‰ï¼_image.we)

å‚è€ƒæ–‡çŒ®:

1.[https://zhuanlan.zhihu.com/p/374230720](https://zhuanlan.zhihu.com/p/374230720)

2.[https://www.yeahchen.cn/2022/05/14/%25E4%25BB%2580%25E4%25B9%2588%25E6%2598%25AF%25E5%2590%2584%25E5%2590%2591%25E5%25BC%2582%25E6%2580%25A7/](https://www.yeahchen.cn/2022/05/14/%25E4%25BB%2580%25E4%25B9%2588%25E6%2598%25AF%25E5%2590%2584%25E5%2590%2591%25E5%25BC%2582%25E6%2580%25A7/)

3.[https://www.zhihu.com/question/354129879/answer/2471212210](https://www.zhihu.com/question/354129879/answer/2471212210)

4.[https://blog.csdn.net/qq\_48314528/article/details/122760494](https://blog.csdn.net/qq_48314528/article/details/122760494)